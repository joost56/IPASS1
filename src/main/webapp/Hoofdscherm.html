<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="Style.css"/>
    <title>Factuur</title>
</head>
<body>
<aside>
    <h2>Menu</h2>
    <hr/>
    <h3>hier komen de klanten</h3>
    <article>
        <input type="submit" value="wijzig klantgegevens" id="wijzig klant gegevens" />&nbsp;
        <button type="button" id="uitloggen"> <a href="index.html">Log uit</a></button>&nbsp;

    </article>
</aside>

<form id="POSTurenform">
<!--        action="/action_page.php"-->
    <label for="uren">Gewerkte uren:<input type="number" id="uren" name="uren"/></label>
    <label for="omschrijving">Uren omschrijving:<input type="text" id="omschrijving" name="omschrijving"/></label>
    <p id="date"></p>
    <input type="button" id="postNoJackson" value="opslaan">
<!--<textarea rows="7" cols="50" name="omschrijving" form="POSTurenform">-->
<!--</textarea>-->
</form>
<section>
    <ul>
        <li><a href="/rest/uren">Bekijk alle uren</a></li>
    </ul>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button onclick="Export2Doc('exportContent');">Genereer als factuur</button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <div id="exportContent">
        <h1>een voorbeeld</h1>
        <p class="hide-me"> dit is gewoon puur als voorbeeld bedoeld want als dit lukt dan ben ik geniaal.


        <h2>Declaratie</h2>

            <table>
                <tr>
                    <th>Datum: 14 april 2020</th>
                    <th>Factuurnummer: 2020 â€“ 1.08</th>
                    <th>Bedrag</th>
                </tr>
                <tr>
                    <th>Wilt u op uw betalingsopdracht bovenstaand factuurnummer vermelden.</th>
                    <th>bedrag</th>
                </tr>
            </table>
        </p>
    </div>
</section>



<script type="text/javascript">
    document.querySelector("#postNoJackson").addEventListener("click", function() {
        var formData = new FormData(document.querySelector("#POSTurenform"));
        var encData = new URLSearchParams(formData.entries());

        fetch("rest/uren/nojackson", {method: 'POST', body: encData})
            .then(response => response.json())
            .then(function (myJson) {
                console.log(myJson);
            });
    });


    //voor de word file
    function Export2Doc(element, filename = ''){
        var preHtml = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>";
        var postHtml = "</body></html>";
        var html = preHtml+document.getElementById(element).innerHTML+postHtml;
        var blob = new Blob(['\ufeff', html], {
            type: 'appliaction/msword'
        });
        var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);
        filename = filename?filename+'.doc':'document.doc';
        var downloadLink = document.createElement("a");
        document.body.appendChild(downloadLink);
        if (navigator.msSaveOrOpenBlob ){
            navigator.msSaveOrOpenBlob(blob, filename);
        }else{
            downloadLink.href = url;
            downloadLink.download = filename;
            downloadLink.click();
        }
        document.body.removeChild(downloadLink);
    }
</script>